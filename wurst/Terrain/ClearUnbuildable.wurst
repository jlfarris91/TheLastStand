package ClearUnbuildable
import TerrainUtils
import MapBounds
import ClosureTimers

let TILES_X = (boundMax.x - boundMin.x).toInt() div 128 + 1
let TILES_Y = (boundMax.y - boundMin.y).toInt() div 128 + 1
let TILES_COUNT = TILES_X * TILES_Y

/** Fills the entire tile (128x128 rect around tile pos) with given type */
public function tile.getPathing(pathingtype ttype) returns bool
  for i = 0 to 3
    for j = 0 to 3
      if (not (this.toVec2() + vec2(-48. + i * 32,-48. + j * 32)).isTerrainPathable(ttype))
        return false
  return true

real g_progress

init

  // doAfter(1.0) () ->

  //   Log.info("Preparing Map...")

  //   doAfter(1.0) () ->

  //     g_progress = 0.0
  //     for x = 0 to TILES_X - 1
  //       nullTimer() ->
  //         for y = 0 to TILES_Y - 1
  //           let tile = tile(x, y)
  //           tile.setPathing(PATHING_TYPE_BUILDABILITY, true)
  //         g_progress = x / TILES_X
        
  //   Log.info("Done.")