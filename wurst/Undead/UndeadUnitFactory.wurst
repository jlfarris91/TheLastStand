package UndeadUnitFactory
import UnitMetadata
import TlsUnitIds
import CryptFiendComponent
import UndeadTargetingComponent
import GameConstants
import GhostComponent
import AbominationComponent
import SummonerComponent
import TlsAbilityIds

// ============================================================================
public class UndeadUnitFactory implements IUnitMetadataFactory

  // --------------------------------------------------------------------------
  override function createUnit(IUnitMetadata metadata) returns bool
    let _unit = metadata.getUnit()
    let unitTypeId = _unit.getTypeId()
    var handled = false

    if (_unit.getOwner() == PLAYER_UNDEAD)
      metadata.addComponent(new UndeadTargetingComponent(metadata))
      handled = true

    if (unitTypeId.isTypeOfAbomination())
      metadata.addComponent(new AbominationComponent(metadata))
      handled = true

    if (unitTypeId.isTypeOfNecromancer())
      metadata.addComponent(new SummonerComponent(metadata)
        ..setAbilityId(TlsAbilityIds.necromancerRaiseDead)
        ..setSummonerUnitTypes(TlsUnitIds.Undead.necromancers[0], TlsUnitIds.Undead.necromancers[1], TlsUnitIds.Undead.necromancers[2]))
      handled = true

    if (unitTypeId.isTypeOfFiend())
      metadata.addComponent(new CryptFiendComponent(metadata))
      handled = true

    if (unitTypeId == TlsUnitIds.Undead.cryptFiendBurrowDummy)
      metadata.addComponent(new CryptFiendDummyComponent(metadata))
      handled = true

    if (unitTypeId == TlsUnitIds.Undead.archimonde)
      metadata.addComponent(new SummonerComponent(metadata)
        ..setAbilityId(TlsAbilityIds.rainOfChaos)
        ..setSummonerUnitTypes(TlsUnitIds.Undead.archimonde, 0, 0))
      handled = true

    if (unitTypeId.isTypeOfGhost())
      metadata.addComponent(new GhostComponent(metadata))
      handled = true

    if (unitTypeId.isTypeOfTombstone())
      metadata.addComponent(new SummonerComponent(metadata)
        ..setAbilityId(TlsAbilityIds.tombstoneSummon)
        ..setSummonerUnitTypes(TlsUnitIds.Undead.darkMinions[0], TlsUnitIds.Undead.darkMinions[1], TlsUnitIds.Undead.darkMinions[2]))
      handled = true

    if (unitTypeId.isTypeOfForgottenOne())
      metadata.addComponent(new SummonerComponent(metadata)
        ..setAbilityId(TlsAbilityIds.spawnTentacles)
        ..setSummonerUnitTypes(TlsUnitIds.Undead.tentacles[0], TlsUnitIds.Undead.tentacles[1], TlsUnitIds.Undead.tentacles[2]))
      handled = true

    return handled