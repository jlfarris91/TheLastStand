package UndeadUnitFactory
import UnitMetadata
import TlsUnitIds
import CryptFiendComponent
import UndeadTargetingComponent
import NecromancerComponent
import ArchimondeComponent
import GameConstants
import GhostComponent
import AbominationComponent
import TombstoneComponent

// ============================================================================
function unitGetsUndeadTargetingComponent(unit _unit) returns bool
  let unitTypeId = _unit.getTypeId()
  return _unit.getOwner() == PLAYER_UNDEAD and
         not unitTypeId.isTypeOfTombstone() and
         not unitTypeId.isTypeOfForgottenOne()

// ============================================================================
public class UndeadUnitFactory implements IUnitMetadataFactory

  // --------------------------------------------------------------------------
  override function createUnit(IUnitMetadata metadata) returns bool
    let _unit = metadata.getUnit()
    let unitTypeId = _unit.getTypeId()
    var handled = false

    if (unitGetsUndeadTargetingComponent(_unit))
      metadata.addComponent(new UndeadTargetingComponent(metadata))
      handled = true

    if (unitTypeId.isTypeOfAbomination())
      metadata.addComponent(new AbominationComponent(metadata))
      handled = true

    if (unitTypeId.isTypeOfNecromancer())
      metadata.addComponent(new NecromancerComponent(metadata))
      handled = true

    if (unitTypeId.isTypeOfFiend())
      metadata.addComponent(new CryptFiendComponent(metadata))
      handled = true

    if (unitTypeId == TlsUnitIds.Undead.cryptFiendBurrowDummy)
      metadata.addComponent(new CryptFiendDummyComponent(metadata))
      handled = true

    if (unitTypeId == TlsUnitIds.Undead.archimonde)
      metadata.addComponent(new ArchimondeComponent(metadata))
      handled = true

    if (unitTypeId.isTypeOfGhost())
      metadata.addComponent(new GhostComponent(metadata))
      handled = true

    if (unitTypeId.isTypeOfTombstone())
      metadata.addComponent(new TombstoneComponent(metadata))
      handled = true

    return handled