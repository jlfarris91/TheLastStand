package AcolyteComponent
import SurvivorJobComponent
import UnitMetadata
import SurvivorJobs
import SurvivorComponent

// ============================================================================
public class AcolyteJobComponent extends SurvivorJobComponent
  
  // --------------------------------------------------------------------------
  construct(IUnitMetadata owner)
    super(owner)

  // --------------------------------------------------------------------------
  override function getJob() returns SurvivorJobDefinition
    return SurvivorJobs.acolyte

// ============================================================================
public function IUnitMetadata.getAcolyteJobComponent() returns AcolyteJobComponent
  return this.getComponent(AcolyteJobComponent.typeId) castTo AcolyteJobComponent

// ============================================================================
public function IUnitMetadata.getOrAddAcolyteJobComponent() returns AcolyteJobComponent
  var component = this.getAcolyteJobComponent()
  if (component == null)
    component = this.addComponent(new AcolyteJobComponent(this), false) castTo AcolyteJobComponent
  return component

function onHeroLeveledUp()
  let leveledUnit = GetLevelingUnit()
  let survivor = leveledUnit.getSurvivorComponent()
  if (survivor == null)
    return
  let activeJobComp = survivor.getActiveJobComponent()
  if (activeJobComp != null)
    activeJobComp.onLevelChanged()

// ============================================================================
init
  SurvivorJobComponent.registerSurvivorJobComponentGetter(SurvivorJobType.Acolyte, AcolyteJobComponent.typeId)
  SurvivorJobComponent.registerSurvivorJobComponentFactory(SurvivorJobType.Acolyte, metadata -> metadata.getOrAddAcolyteJobComponent())