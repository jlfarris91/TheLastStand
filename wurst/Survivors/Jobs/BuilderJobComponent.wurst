package BuilderJobComponent
import SurvivorJobComponent
import UnitMetadata
import SurvivorJobs
import LumberHarvestComponent

// ============================================================================
public class BuilderJobComponent extends SurvivorJobComponent
  
  // --------------------------------------------------------------------------
  construct(IUnitMetadata owner)
    super(owner)

  // --------------------------------------------------------------------------
  override function getTypeId() returns int
    return BuilderJobComponent.typeId

  // --------------------------------------------------------------------------
  override function getJob() returns SurvivorJobDefinition
    return SurvivorJobs.builder

  // --------------------------------------------------------------------------
  override function onEnabled()
    super.onEnabled()
    getOwner().getOrAddLumberHarvestComponent().enable()

  // --------------------------------------------------------------------------
  override function onDisabled()
    super.onDisabled()

    let lumberHarvestComponent = getOwner().getOrAddLumberHarvestComponent()
    if (lumberHarvestComponent != null)
      lumberHarvestComponent.disable()

// ============================================================================
public function IUnitMetadata.getBuilderJobComponent() returns BuilderJobComponent
  return this.getComponent(typeInfo(BuilderJobComponent.typeId)) castTo BuilderJobComponent

// ============================================================================
public function IUnitMetadata.getOrAddBuilderJobComponent() returns BuilderJobComponent
  var component = this.getBuilderJobComponent()
  if (component == null)
    component = this.addComponent(new BuilderJobComponent(this), false) castTo BuilderJobComponent
  return component

// ============================================================================
init
  SurvivorJobComponent.registerSurvivorJobComponentGetter(SurvivorJobs.builder, metadata -> metadata.getBuilderJobComponent())
  SurvivorJobComponent.registerSurvivorJobComponentFactory(SurvivorJobs.builder, metadata -> metadata.getOrAddBuilderJobComponent())