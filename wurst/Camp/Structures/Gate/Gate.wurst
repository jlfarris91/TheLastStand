package Gate
import Unit_Gate
import CampStructure
import ICamp

public class Gate extends CampStructure
  private real _angle

  construct(ICamp camp, unit u)
    super(camp, u)

  function rotateGate()
    let unitId = this._unit.getTypeId()
    let pos = this._unit.getPos()
    let owner = this._unit.getOwner()
    
    this._unit.remove()

    unit replaced

    if (unitId == UNIT_ID_GATE_HORIZONTAL_CLOSED)
      replaced = CreateUnit(owner, UNIT_ID_GATE_DIAGONAL_CLOSED, pos.x, pos.y, _angle)
    else
      this._angle -= 90.0
      replaced = CreateUnit(owner, UNIT_ID_GATE_HORIZONTAL_CLOSED, pos.x, pos.y, _angle)
    
    replaced.setLife(this._unit.getLife())

    replaced.setPathing(false)
    replaced.setPos(pos)
    replaced.setPathing(true)
    
    owner.select(replaced)
