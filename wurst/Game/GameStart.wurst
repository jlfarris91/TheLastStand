package GameStart
import GameConstants
import HumanPlayers
import Heroes

constant real TIME_OF_DAY_INITIAL = 5.0
constant real GAME_SPEED_INITIAL = 50.0

function initializeGeneral()
  EnableMinimapFilterButtons(true, false)
  SetPlayerFlagBJ(PLAYER_STATE_GIVES_BOUNTY, true, PLAYER_UNDEAD)
  CameraSetSmoothingFactor(5.0)
  SetCreepCampFilterState(false)
  SetTimeOfDayScalePercentBJ(GAME_SPEED_INITIAL)
  SetTimeOfDay(TIME_OF_DAY_INITIAL)
  FogEnableOn()

function initializeAlliances()
  for p in g_HumanPlayers
    // Make player treat undead as an enemy
    SetPlayerAllianceStateBJ(p, PLAYER_UNDEAD, bj_ALLIANCE_UNALLIED)
    // Make undead treat player as an enemy
    SetPlayerAllianceStateBJ(PLAYER_UNDEAD, p, bj_ALLIANCE_UNALLIED )
    // Make player treat villagers as nuetral
    SetPlayerAllianceStateBJ(p, PLAYER_VILLAGERS, bj_ALLIANCE_NEUTRAL )
    // Make villagers treat player as nuetral
    SetPlayerAllianceStateBJ(PLAYER_VILLAGERS, p, bj_ALLIANCE_NEUTRAL )
    // Turn off undead shared vision with player (probably unnecessary)
    SetPlayerAllianceBJ(PLAYER_UNDEAD, ALLIANCE_SHARED_VISION, false, p)

function delayedStart()
  spawnHeroesForPlayers()

  for p in g_PlayingHumanPlayers
    // Create a visible region around the base units
    createVision(p, gg_rct_BaseUnits, false)

init
  initializeGeneral()
  initializeAlliances()

  var t = CreateTimer()
  t.start(0.1, function delayedStart)