package NightWave
import Wave
import ClosureTimers
import StringBuilder

// ============================================================================
public class NightWave extends Wave
  private int m_night
  private real m_timeOfDayScalePercent

  // --------------------------------------------------------------------------
  construct(int night)
    m_night = night
    m_timeOfDayScalePercent = 100.0

  // --------------------------------------------------------------------------
  function getNight() returns int
    return m_night

  // --------------------------------------------------------------------------
  function getTimeOfDayScalePercent() returns real
    return m_timeOfDayScalePercent

  // --------------------------------------------------------------------------
  function setTimeOfDayScalePercent(real value)
    m_timeOfDayScalePercent = value

  // --------------------------------------------------------------------------
  override function onStarted()
    super.onStarted()
    
    Log.info("Starting night wave " + I2S(getNight()))

    // Have to wait for some reason
    doAfter(0.1) ->
      Log.info("Set night speed to " + R2S(m_timeOfDayScalePercent))
      SetTimeOfDayScalePercentBJ(m_timeOfDayScalePercent)
  
  // --------------------------------------------------------------------------
  override function getDebugString(IStringBuilder sb)
    sb.appendLine("===== Night Wave " + I2S(m_night) + " (" + getStatusString() +  ") =====")
    super.getDebugString(sb)