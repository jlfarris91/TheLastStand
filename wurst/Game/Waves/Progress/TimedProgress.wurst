package TimedProgress
import Runnable
import GameTimer
import IProgress

// ============================================================================
public class TimedProgress extends Runnable implements IProgress
  private real m_duration
  private real m_startTime
  private real m_elapsedTime

  // --------------------------------------------------------------------------
  construct()
    m_duration = 0
    m_startTime = 0
    m_elapsedTime = 0

  // --------------------------------------------------------------------------
  function getDuration() returns real
    return m_duration
  
  // --------------------------------------------------------------------------
  function setDuration(real value)
    m_duration = value

  // --------------------------------------------------------------------------
  override function getProgress() returns real
    return ((currentTime - m_startTime) + m_elapsedTime) / m_duration

  // --------------------------------------------------------------------------
  override function onStarted()
    super.onStarted()
    m_startTime = currentTime
    m_elapsedTime = 0.0

  override function onStopped()
    super.onStopped()
    m_startTime = -1.0
    m_elapsedTime = 0.0

  // --------------------------------------------------------------------------
  override function onPaused()
    super.onPaused()
    m_elapsedTime += currentTime - m_startTime

  // --------------------------------------------------------------------------
  override function onResumed()
    super.onResumed()
    m_startTime = currentTime