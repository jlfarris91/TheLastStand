package WaveActivator
import Runnable
import Events

// ============================================================================
public interface IWaveActivator extends IRunnable
  function getActivatedEvent() returns Event
  function getTimesActivated() returns int

// ============================================================================
public abstract class WaveActivatorBase extends Runnable implements IWaveActivator
  private int m_numTimesActivated
  private bool m_activateOnStart = true
  private Event m_activated

  // --------------------------------------------------------------------------
  construct()
    m_activated = new Event()

  // --------------------------------------------------------------------------
  ondestroy
    destroy m_activated

  // --------------------------------------------------------------------------
  override function getActivatedEvent() returns Event
    return m_activated

  // --------------------------------------------------------------------------
  override function getTimesActivated() returns int
    return m_numTimesActivated

  // --------------------------------------------------------------------------
  override function reset()
    super.reset()
    m_numTimesActivated = 0

  // --------------------------------------------------------------------------
  override function onStarted()
    super.onStarted()
    if (m_activateOnStart)
      raiseActivatedEvent()

  // --------------------------------------------------------------------------
  function getActivateOnStart() returns bool
    return m_activateOnStart

  // --------------------------------------------------------------------------
  function setActivateOnStart(bool value)
    m_activateOnStart = value

  // --------------------------------------------------------------------------
  protected function raiseActivatedEvent()
    m_numTimesActivated++
    m_activated.call()