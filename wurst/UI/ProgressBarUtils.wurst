package ProgressBarUtils
import public ProgressBar
import ErrorHandling

ProgressBar array g_progressBarFreeList
int g_progressBarFreeListCount = 0

// ============================================================================
public function getProgressBar() returns ProgressBar
  ProgressBar progressBar
  if (g_progressBarFreeListCount > 0)
    g_progressBarFreeListCount--
    progressBar = g_progressBarFreeList[g_progressBarFreeListCount]
  else
    progressBar = new ProgressBar()
  return progressBar

// ============================================================================
public function ProgressBar.release()

  for i = 0 to g_progressBarFreeListCount-1
    if (g_progressBarFreeList[i] == this)
      error("Double release of ProgressBar")

  g_progressBarFreeList[g_progressBarFreeListCount] = this
  g_progressBarFreeListCount++

  this.hide()
  this.setProgress(null)