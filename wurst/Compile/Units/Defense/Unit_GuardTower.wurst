package Unit_GuardTower
import TlsBuildingDefinition
import BuildingUndeadTarget
import GameConstants
import TlsUpgradeIds
import TlsUnitDefinitionBuilder

public TlsBuildingDefinition g_guardTowerDefinition

// ============================================================================
public class GuardTowerDefinition extends TlsBuildingDefinition
  construct(int newId)
    super(newId, UnitIds.guardtower)
    addUndeadTargetBuildingDefinition(newId, false)
    setName("Guard Tower")
    setButtonPositionX(2)
    setButtonPositionY(0)
    setDeathTimeseconds(1.0)
    //setIconGameInterface("ReplaceableTextures\\CommandButtons\\BTNWorkbench.dds")
    //setModelFile("Units\\Workbench\\Workbench.mdx")
    setScalingValue(1.0)
    setSelectionScale(3.0)
    setTintingColorRed(200)
    setTintingColorBlue(200)
    setTintingColorGreen(200)
    setPlacementRequires("unbuildable,unwalkable")
    setHideMinimapDisplay(true)
    setRepairTime(10)
    setSightRadiusDay(STRUCTURE_LARGE_SIGHT_RANGE_DAY)
    setSightRadiusNight(STRUCTURE_LARGE_SIGHT_RANGE_NIGHT)
    setRequirements(commaList(TlsUnitIds.workshop))
    setUpgradesUsed(commaList(TlsUpgradeIds.campDefense))
    setNormalAbilities(commaList(
      TlsAbilityIds.recycle,
      TlsAbilityIds.blightDispelSmall,
      TlsAbilityIds.workstationLoadUnit,
      TlsAbilityIds.workstationUnloadUnit,
      TlsAbilityIds.inventory2Slots))
    setUnitsTrained("")
    setUpgradesTo("")
    
    setHitPointsMaximumBase(500)
    setArmorType(ArmorType.Fortified)
    setDefenseBase(0)

    setGoldCost(0)
    setMaterialCost(200)
    this.setCommonBuildingProperties()    

    setHotkey("G")
    setTooltipBasic("Build Guard Tower")

// ============================================================================
@compiletime function createUnit()

  g_guardTowerDefinition = new GuardTowerDefinition(TlsUnitIds.guardTower)
    ..addUnitClassification(TlsUnitClassification.BUILDING)
    ..addUnitClassification(TlsUnitClassification.RANGED)
    ..addUnitClassification(TlsUnitClassification.WORKSTATION)

  destroy new TlsUnitDefinitionBuilder()
    ..setDescription("A tall tower fitted with a crossbow that can fire a variable distance when operated by a survivor.")
    ..apply(g_guardTowerDefinition, tooltipBuilder -> begin
        let workstationItem = new TooltipItem("[Operator Bonuses]")
        ..addValue("Increased attack range")
        ..addValue("Increased attack speed")
        tooltipBuilder.addItem(workstationItem)
      end)

// ============================================================================
init
  createUnit()