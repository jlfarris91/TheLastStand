package Unit_Shelter
import TlsBuildingDefinition
import GameConstants
import TlsUpgradeIds
import ColorUtility
import BuildingUndeadTarget
import Icons
import ChannelAbilityPreset
import Buildings

public TlsBuildingDefinition g_shelter1Definition
public TlsBuildingDefinition g_shelter2Definition
public TlsBuildingDefinition g_shelter3Definition

public constant int SHELTER_1_ICON_ID = compiletime(ABIL_ID_GEN.next())
public constant int SHELTER_2_ICON_ID = compiletime(ABIL_ID_GEN.next())
public constant int SHELTER_3_ICON_ID = compiletime(ABIL_ID_GEN.next())
public constant int SHELTER_NO_EFFECT_ICON_ID = compiletime(ABIL_ID_GEN.next())

// ============================================================================
public class ShelterDefinition extends TlsBuildingDefinition
  construct(int newId)
    super(newId, UnitIds.tent)
    this.makeBuildingUndeadTarget()
    setHotkey("E")
    setRace(Race.Human)
    setButtonPositionX(0)
    setButtonPositionY(0)
    setDeathTimeseconds(2.27)
    setGroundTexture("")
    setScalingValue(0.7)
    setSelectionScale(2.5)
    setDeathTimeseconds(3.0)
    setShadowTextureBuilding("")
    setArmorType(ArmorType.Fortified)
    setDeathType(DeathType.CannotRaiseDoesNotDecay)
    setCategorizationSpecial(false)
    setPathingMap("PathTextures\\4x4SimpleSolid.tga")
    setPlacementRequires("unbuildable,unwalkable")
    setBuildTime(BUILD_TIME_BUILDING_SMALL)
    setRepairTime(REPAIR_TIME_BUILDING_SMALL)
    setHideMinimapDisplay(true)
    setSightRadiusDay(STRUCTURE_MEDIUM_SIGHT_RANGE_DAY)
    setSightRadiusNight(STRUCTURE_MEDIUM_SIGHT_RANGE_NIGHT)
    setUpgradesUsed(commaList(TlsUpgradeIds.campDefense))
    setFoodProduced(0)

// ============================================================================
@compiletime function createUnits()
  g_shelter1Definition = new ShelterDefinition(TlsUnitIds.shelter1)
    ..setName("Shelter")
    ..setTooltipBasic("Build Shelter")
    ..setTooltipExtended("A makeshift covering that provides limited shelter for a survivor.|n|nEach Basic Shelter increases the max HP of all survivors by {0}.|n|n{1}".format(
        SURVIVOR_HP_BONUS_SHELTER_1.toString(),
        "Survivors will occasionally spawn in your camp as long as you have food available.".colorize(Colors.gold)))
    ..setIconGameInterface("ReplaceableTextures\\CommandButtons\\BTNTent.blp")
    ..setModelFile("Buildings\\Shelter\\Shelter.mdx")
    ..setScalingValue(0.7)
    ..setNormalAbilities(commaList(
      TlsAbilityIds.shelter1CargoHold, 
      TlsAbilityIds.tentLoad, 
      TlsAbilityIds.tentUnload, 
      SHELTER_1_ICON_ID,
      TlsAbilityIds.recycle))
    ..setUpgradesTo(commaList(TlsUnitIds.shelter2))
    ..setRequirements("")
    ..setHitPointsMaximumBase(250)
    ..setFoodCost(0)
    ..setFoodProduced(0)
    ..setGoldCost(0)
    ..setLumberCost(200)
    ..setCommonBuildingProperties()

  g_shelter2Definition = new ShelterDefinition(TlsUnitIds.shelter2)
    ..setName("Tent")
    ..setTooltipBasic("Upgrade to Tent")
    ..setTooltipExtended("A sturdy tent that provides shelter for a survivor.|n|nEach Tent increases the max HP of all survivors by {0}.|n|n{1}".format(
        SURVIVOR_HP_BONUS_SHELTER_2.toString(),
        "Survivors will occasionally spawn in your camp as long as you have food available.".colorize(Colors.gold)))
    ..setIconGameInterface("ReplaceableTextures\\CommandButtons\\BTNTent1.blp")
    ..setModelFile(Buildings.tent)
    ..setScalingValue(0.7)
    ..setNormalAbilities(commaList(
      TlsAbilityIds.shelter2CargoHold,
      TlsAbilityIds.tentLoad, 
      TlsAbilityIds.tentUnload, 
      SHELTER_2_ICON_ID,
      TlsAbilityIds.recycle))
    ..setUpgradesTo(commaList(TlsUnitIds.shelter3))
    ..setRequirements(commaList(TlsUnitIds.obelisk1))
    ..setHitPointsMaximumBase(500)
    ..setFoodCost(0)
    ..setFoodProduced(0)
    ..setGoldCost(0)
    ..setLumberCost(200)
    ..setCommonBuildingProperties(g_shelter1Definition)
  
  g_shelter3Definition = new ShelterDefinition(TlsUnitIds.shelter3)
    ..setName("Shack")
    ..setTooltipBasic("Upgrade to Shack")
    ..setTooltipExtended("A sturdy shack that provides shelter for a survivor.|n|nEach Shack increases the max HP of all survivors by {0}.|n|n{1}".format(
        SURVIVOR_HP_BONUS_SHELTER_3.toString(),
        "Survivors will occasionally spawn in your camp as long as you have food available.".colorize(Colors.gold)))
    ..setIconGameInterface(Icons.bTNGenericCreepBuilding)
    ..setModelFile(Buildings.gnollHut)
    ..setNormalAbilities(commaList(
      TlsAbilityIds.shelter3CargoHold,
      TlsAbilityIds.tentLoad,
      TlsAbilityIds.tentUnload,
      SHELTER_3_ICON_ID,
      TlsAbilityIds.recycle))
    ..setRequirements("")
    ..setHitPointsMaximumBase(1500)
    ..setFoodCost(0)
    ..setFoodProduced(0)
    ..setGoldCost(1)
    ..setLumberCost(200)
    ..setCommonBuildingProperties(g_shelter2Definition)

  new AbilityDefinition(SHELTER_1_ICON_ID, 'Ahan')
    ..setName("Shelter 1 Info")
    ..setTooltipNormal(1, g_shelter1Definition.getName())
    ..setTooltipNormalExtended(1, "This {0} is providing a bonus {1} max HP to all Survivors.".format(g_shelter1Definition.getName(), SURVIVOR_HP_BONUS_SHELTER_1.toString()))
    ..setIconNormal("ReplaceableTextures\\CommandButtons\\PASTent.blp")
    ..setButtonPositionNormalX(1)
    ..setButtonPositionNormalY(2)

  new AbilityDefinition(SHELTER_2_ICON_ID, 'Ahan')
    ..setName("Shelter 2 Info")
    ..setTooltipNormal(1, g_shelter2Definition.getName())
    ..setTooltipNormalExtended(1, "This {0} is providing a bonus {1} max HP to all Survivors.".format(g_shelter2Definition.getName(), SURVIVOR_HP_BONUS_SHELTER_2.toString()))
    ..setIconNormal("ReplaceableTextures\\CommandButtons\\PASTent1.blp")
    ..setButtonPositionNormalX(1)
    ..setButtonPositionNormalY(2)

  new AbilityDefinition(SHELTER_3_ICON_ID, 'Ahan')
    ..setName("Shelter 3 Info")
    ..setTooltipNormal(1, g_shelter3Definition.getName())
    ..setTooltipNormalExtended(1, "This {0} is providing a bonus {1} max HP to all Survivors.".format(g_shelter3Definition.getName(), SURVIVOR_HP_BONUS_SHELTER_3.toString()))
    ..setIconNormal("ReplaceableTextures\\CommandButtons\\PASGenericCreepBuilding.blp")
    ..setButtonPositionNormalX(1)
    ..setButtonPositionNormalY(2)

  new AbilityDefinition(SHELTER_NO_EFFECT_ICON_ID, 'Ahan')
    ..setName("Shelter No Effect")
    ..setTooltipNormal(1, "Shelter Has No Effect!")
    ..setTooltipNormalExtended(1, "You have too many Shelters. This Shelter is providing no HP bonus.")
    ..setIconNormal("ReplaceableTextures\\CommandButtons\\PASCancel.blp")
    ..setButtonPositionNormalX(1)
    ..setButtonPositionNormalY(2)

// ============================================================================
init
  createUnits()