package Ability_SpikeBarrage
import TlsAbilityIds
import AbilityObjEditing
import ObjectIds

// ============================================================================
// These values must match the attack 1 values of the spikes unit.
// https://www.hiveworkshop.com/threads/multiple-targets.11615/
// ============================================================================

constant real g_cooldown = 0.6
constant int g_maxNumberOfTargets = 9
constant real array g_damagePerTarget = [8, 32, 60, 120, 400]

// ============================================================================
@compiletime function createAbility()

  new AbilityDefinitionRocketAttack(TlsAbilityIds.spikeBarrage)
    ..setLevels(5)
    ..setMissileArt("Objects\\Spawnmodels\\Undead\\UndeadBlood\\UndeadBloodGhoul.mdl")
    ..setMissileArc(0.0)
    ..setMissileHomingEnabled(true)
    ..setMissileSpeed(9999)
    ..presetAreaofEffect((int lvl) -> 100.0)
    ..presetTargetsAllowed((int lvl) -> commaList(TargetsAllowed.ground, TargetsAllowed.organic))
    ..presetDamagePerTarget((int lvl) -> g_damagePerTarget[lvl - 1])
    ..presetMaximumNumberofTargets((int lvl) -> g_maxNumberOfTargets)
    ..presetMaximumTotalDamage((int lvl) -> g_maxNumberOfTargets * g_damagePerTarget[lvl - 1])
    ..presetCooldown((int lvl) -> g_cooldown)
    ..presetDurationNormal((int lvl) -> 1.0) // not sure why this needs to be 1 but it does?
    ..setRequirements("")
    ..setName("Spikes")
    ..presetTooltipNormal((int lvl) -> "Spikes [Level {0}]".format(lvl.toString()))
    ..presetTooltipNormalExtended((int lvl) -> "Spikes attack multiple enemies simultaneously.")
