package Item_Materials
import RegisterEvents
import GameConstants
import PlayerExtensions
import PlayerMetadata
import FX
import MainItemLibrary
import TlsItemIds


function onItemAcquired()
  var u = GetManipulatingUnit()
  var i = GetManipulatedItem()
  var owner = u.getOwner()

  if (not owner.isHumanPlayer())
    return

  if (i.getTypeId() != TlsItemIds.materials)
    return

  i.remove()
  
  var reward = GetRandomInt(MATERIALS_ITEM_REWARD_MIN, MATERIALS_ITEM_REWARD_MAX)
  owner.giveMaterials(reward)

  var x = u.getX()
  var y = u.getY()

  FX.createGoldCreditEffect(x, y, owner)
  FX.createFoundMaterialsTag(x, y, reward, owner)

init
  registerPlayerUnitEvent(EVENT_PLAYER_UNIT_PICKUP_ITEM, function onItemAcquired)
  
  g_MainItemLibrary.commonSet.add(TlsItemIds.materials, 50.0)