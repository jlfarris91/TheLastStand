package SetupCamp
import RegisterEvents
import TlsUnitIds
import TlsAbilityIds

// ============================================================================
function onConstructFinish()
  let constructedUnit = GetConstructedStructure()
  let constructedUnitId = constructedUnit.getTypeId()
  
  if (constructedUnitId == TlsUnitIds.campTent or
      constructedUnitId == TlsUnitIds.campHouse or
      constructedUnitId == TlsUnitIds.campHall)
    SetPlayerAbilityAvailableBJ(true, TlsAbilityIds.moveCamp, constructedUnit.getOwner())
    SetPlayerAbilityAvailableBJ(false, TlsAbilityIds.setupCamp, constructedUnit.getOwner())

// ============================================================================
function onUnitDeath()
  let dyingUnit = GetDyingUnit()
  let dyingUnitId = dyingUnit.getTypeId()

  if (dyingUnitId == TlsUnitIds.campTent or
      dyingUnitId == TlsUnitIds.campHouse or
      dyingUnitId == TlsUnitIds.campHall)
    SetPlayerAbilityAvailableBJ(false, TlsAbilityIds.moveCamp, dyingUnit.getOwner())
    SetPlayerAbilityAvailableBJ(true, TlsAbilityIds.setupCamp, dyingUnit.getOwner())

// ============================================================================
init
  registerPlayerUnitEvent(EVENT_PLAYER_UNIT_CONSTRUCT_FINISH, function onConstructFinish)
  registerPlayerUnitEvent(EVENT_PLAYER_UNIT_DEATH, function onUnitDeath)