package BatteryComponent
import UnitComponent
import PowerConsumerComponent
import PowerSourceComponent

constant POWER_CONSUMPTION_RATE = 2.0

// ============================================================================
public class BatteryComponent extends UnitComponent
  private PowerConsumerComponent m_powerConsumer
  private PowerSourceComponent m_powerSource

  // --------------------------------------------------------------------------
  construct (IUnitMetadata metadata)
    super(metadata)
    m_powerConsumer = null
    m_powerSource = null

  // --------------------------------------------------------------------------
  override function getTypeId() returns int
    return BatteryComponent.getTypeId()

  // --------------------------------------------------------------------------
  override function onEnabled()
    super.onEnabled()

    m_powerConsumer = getOwner().getOrAddPowerConsumerComponent()
    m_powerSource = getOwner().getOrAddPowerSourceComponent()

  // --------------------------------------------------------------------------
  override function onDisabled()
    super.onDisabled()

// ============================================================================
public function IUnitMetadata.getBatteryComponent() returns BatteryComponent
  return this.getComponent(typeInfo(BatteryComponent.typeId)) castTo BatteryComponent

// ============================================================================
public function IUnitMetadata.getOrAddBatteryComponent() returns BatteryComponent
  var component = this.getBatteryComponent()
  if (component == null)
    component = this.addComponent(new BatteryComponent(this)) castTo BatteryComponent
  return component