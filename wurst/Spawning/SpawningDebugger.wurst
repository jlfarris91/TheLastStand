package SpawningDebugger
import Frame
import ProjectConstants
import DebuggerDialog
import World

// ============================================================================
class SpawningDebugger extends DebuggerRealtimeUpdateFrame

  // --------------------------------------------------------------------------
  construct()
    super(createFrame("TEXTAREA", "WaveDebugger", GAME_UI, "", 0))

  // --------------------------------------------------------------------------
  override function realtimeUpdate(real _)

    let frameHandle = getFrameHandle()
    let queue = World.unitSpawnThread.getQueue()

    BlzFrameSetText(frameHandle, "Spawning: q:{0} sw:{1} w:{2} c:{3} t:{4}".format(
      World.unitSpawnThread.getRemainingWorkCount().toString(),
      World.unitSpawnThread.getTotalSubWorkCompletedCount().toString(),
      World.unitSpawnThread.getCompletedJobsCount().toString(),
      World.unitSpawnThread.getCanceledWorkCount().toString(),
      World.unitSpawnThread.getTimedOutWorkCount().toString()))

    for request in queue
      BlzFrameAddText(frameHandle, " > " + request.getDebuggerStateString())

// ============================================================================
init
  if (DEV_ENVIRONMENT)
    DebuggerDialog.registerFrame("SPWN", () -> new SpawningDebugger())